{
    "componentChunkName": "component---node-modules-gatsby-theme-primer-wiki-src-templates-post-query-js",
    "path": "/AWS/SendCommand/",
    "result": {"data":{"mdx":{"id":"925cf620-15b1-5a54-8951-6c67e7b169b7","tableOfContents":{},"fields":{"title":"SendCommand","slug":"/AWS/SendCommand/","url":"https://dst03106.github.io/AWS/SendCommand/","editUrl":"https://github.com/dst03106/dst03106.github.io/AWS/SendCommand.md","lastUpdatedAt":"2024-01-14T16:00:00.000Z","lastUpdated":"1/14/2024","gitCreatedAt":"2024-01-14T15:27:46.000Z","shouldShowTitle":true},"frontmatter":{"title":"","description":null,"imageAlt":null,"tags":[],"date":null,"dateModified":null,"language":null,"seoTitle":null,"image":null},"body":"var _excluded = [\"components\"];\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h3\", {\n    \"id\": \"배경\"\n  }, \"\\uBC30\\uACBD\"), mdx(\"p\", null, \"\\uC5EC\\uB7EC \\uC778\\uC2A4\\uD134\\uC2A4\\uC5D0 \\uBA85\\uB839\\uC744 \\uBCF4\\uB0B4 \\uD504\\uB85C\\uC138\\uC2A4\\uB97C stop \\uD574\\uC57C \\uD588\\uB2E4.\\n\\uC778\\uC2A4\\uD134\\uC2A4\\uC5D0 \\uC811\\uC18D\\uD574 \\uD558\\uB098 \\uD558\\uB098 \\uBA85\\uB839\\uC744 \\uC37C\\uC5C8\\uB294\\uB370, aws \\uC5D0\\uC11C \\uC5ED\\uC2DC \\uC5EC\\uB7EC \\uC778\\uC2A4\\uD134\\uC2A4\\uC5D0 \\uBA85\\uB839\\uC744 \\uBCF4\\uB0BC \\uC218 \\uC788\\uB294 \\uBC29\\uBC95\\uC774 \\uC788\\uB294 \\uAC83\\uC744 \\uC54C\\uAC8C \\uB418\\uC5B4 \\uD574\\uB2F9 \\uBC29\\uBC95\\uC744 \\uC0AC\\uC6A9\\uD574\\uBCF4\\uB824\\uACE0 \\uD55C\\uB2E4. \"), mdx(\"h3\", {\n    \"id\": \"테스트\"\n  }, \"\\uD14C\\uC2A4\\uD2B8\"), mdx(\"p\", null, \"\\uC6B0\\uC120 AWS Run command \\uBB38\\uC11C\\uB97C \\uCC38\\uC870\\uD558\\uC5EC \\uC544\\uB798 \\uBA85\\uB839\\uC744 \\uBCF4\\uB0C8\\uB2E4.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"aws ssm send-command \\\\\\n    --instance-ids \\\"instance-ID\\\" \\\\\\n    --document-name \\\"AWS-RunShellScript\\\" \\\\\\n    --comment \\\"IP config\\\" \\\\\\n    --parameters commands=ifconfig \\\\\\n    --output text\\n\")), mdx(\"p\", null, \"(\\uCC38\\uACE0 \\uB9C1\\uD06C : \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.aws.amazon.com/ko_kr/systems-manager/latest/userguide/walkthrough-cli.html#walkthrough-cli-example-1\"\n  }, \"https://docs.aws.amazon.com/ko_kr/systems-manager/latest/userguide/walkthrough-cli.html#walkthrough-cli-example-1\"), \")\"), mdx(\"h3\", {\n    \"id\": \"트러블슈팅\"\n  }, \"\\uD2B8\\uB7EC\\uBE14\\uC288\\uD305\"), mdx(\"h4\", {\n    \"id\": \"1-ssmsendcommand-시-accessdeniedexception-발생\"\n  }, \"1. ssm:SendCommand \\uC2DC AccessDeniedException \\uBC1C\\uC0DD\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"An error occurred (AccessDeniedException) when calling the SendCommand operation:\\n~~\\nbecause no identity-based policy allows the ssm:SendCommand action\\n\")), mdx(\"p\", null, \"iam \\uAD8C\\uD55C\\uC744 ssm:SendCommand \\uB9CC \\uC8FC\\uC5C8\\uC5C8\\uB294\\uB370 ssm:\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"*\"), \"\\uB85C \\uBCC0\\uACBD\\uD558\\uB2C8  \\uC704 \\uC5D0\\uB7EC\\uAC00 \\uB098\\uC9C0 \\uC54A\\uC558\\uB2E4.\\n\\uC704 \\uAD8C\\uD55C \\uAD00\\uB828 \\uC5D0\\uB7EC\\uB97C \\uC870\\uC0AC\\uD558\\uBA74\\uC11C \\uCCAB\\uBC88\\uC9F8, AWS\\uB294 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"identity-based policies\"), \"\\uC640 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"resource-based policies\"), \"\\uB97C \\uAC16\\uACE0 \\uC788\\uB294 \\uAC83\\uC744 \\uC54C\\uAC8C \\uB418\\uC5C8\\uB2E4. \\uB610\\uD55C \\uB458 \\uC911 \\uD558\\uB098\\uB9CC \\uCDA9\\uC871\\uD574\\uB3C4 \\uB418\\uC9C0 \\uC54A\\uB294\\uB2E4. (\\uCC38\\uACE0 \\uB9C1\\uD06C : \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_identity-vs-resource.html\"\n  }, \"https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_identity-vs-resource.html\"), \")\\n\\uAD81\\uAE08\\uD574\\uC9C4 \\uAC83\\uC740 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"identity\"), \" \\uAD8C\\uD55C\\uC740 iam\\uC5D0 \\uC815\\uC758\\uD558\\uBA74 \\uB418\\uC9C0\\uB9CC \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"resource\"), \" \\uAD8C\\uD55C\\uC740 \\uC5B4\\uB514\\uC5D0 \\uC815\\uC758\\uB418\\uB294 \\uAC83\\uC77C\\uAE4C\\n\\uB450\\uBC88\\uC9F8\\uB85C \\uD14C\\uC2A4\\uD2B8 \\uCEE4\\uB9E8\\uB4DC \\uBA85\\uB839\\uC758 \\uD30C\\uB77C\\uBBF8\\uD130\\uC5D0 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"--document-name\"), \" \\uC774 \\uC788\\uB294\\uB370 \\uB9D0 \\uADF8\\uB300\\uB85C \\uC2A4\\uD06C\\uB9BD\\uD2B8 \\uBB38\\uC11C\\uB97C \\uB9CC\\uB4E4\\uBA74 \\uADF8 \\uC774\\uB984\\uC73C\\uB85C \\uD574\\uB2F9 \\uBA85\\uB839\\uC744 \\uC2E4\\uD589\\uC2DC\\uD0AC \\uC218 \\uC788\\uB294 \\uAC83 \\uAC19\\uB2E4. \"), mdx(\"h3\", {\n    \"id\": \"다음에-해보려고-하는-것\"\n  }, \"\\uB2E4\\uC74C\\uC5D0 \\uD574\\uBCF4\\uB824\\uACE0 \\uD558\\uB294 \\uAC83\"), mdx(\"p\", null, \"aws \\uB85C\\uADF8\\uB97C \\uBCFC \\uC218 \\uC788\\uB294 \"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  })));\n}\n;\nMDXContent.isMDXComponent = true;","rawBody":"### 배경\n여러 인스턴스에 명령을 보내 프로세스를 stop 해야 했다. \n인스턴스에 접속해 하나 하나 명령을 썼었는데, aws 에서 역시 여러 인스턴스에 명령을 보낼 수 있는 방법이 있는 것을 알게 되어 해당 방법을 사용해보려고 한다. \n\n### 테스트\n우선 AWS Run command 문서를 참조하여 아래 명령을 보냈다.\n```\naws ssm send-command \\\n    --instance-ids \"instance-ID\" \\\n    --document-name \"AWS-RunShellScript\" \\\n    --comment \"IP config\" \\\n    --parameters commands=ifconfig \\\n    --output text\n```\n(참고 링크 : https://docs.aws.amazon.com/ko_kr/systems-manager/latest/userguide/walkthrough-cli.html#walkthrough-cli-example-1)\n\n### 트러블슈팅\n#### 1. ssm:SendCommand 시 AccessDeniedException 발생 \n\n```\nAn error occurred (AccessDeniedException) when calling the SendCommand operation:\n~~\nbecause no identity-based policy allows the ssm:SendCommand action\n```\n\niam 권한을 ssm:SendCommand 만 주었었는데 ssm:`*`로 변경하니  위 에러가 나지 않았다. \n위 권한 관련 에러를 조사하면서 첫번째, AWS는 `identity-based policies`와 `resource-based policies`를 갖고 있는 것을 알게 되었다. 또한 둘 중 하나만 충족해도 되지 않는다. (참고 링크 : https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_identity-vs-resource.html) \n궁금해진 것은 `identity` 권한은 iam에 정의하면 되지만 `resource` 권한은 어디에 정의되는 것일까\n두번째로 테스트 커맨드 명령의 파라미터에 `--document-name` 이 있는데 말 그대로 스크립트 문서를 만들면 그 이름으로 해당 명령을 실행시킬 수 있는 것 같다. \n\n### 다음에 해보려고 하는 것 \naws 로그를 볼 수 있는 \n- ","excerpt":"배경 여러 인스턴스에 명령을 보내 프로세스를 stop 해야 했다. \n인스턴스에 접속해 하나 하나 명령을 썼었는데, aws 에서 역시 여러 인스턴스에 명령을 보낼 수 있는 방법이 있는 것을 알게 되어 해당 방법을 사용해보려고 한다.  테스트 우선 AW…","outboundReferences":[],"inboundReferences":[]},"tagsOutbound":{"nodes":[]}},"pageContext":{"tags":[],"slug":"/AWS/SendCommand/","sidebarItems":[{"title":"Categories","items":[{"title":"AWS","url":"","items":[{"title":"SendCommand","url":"/AWS/SendCommand/","items":[]}]},{"title":"Obsibian Template for Gatsby Theme Primer Wiki","url":"/","items":[]}]}],"tagsGroups":[],"latestPosts":[{"fields":{"slug":"/AWS/SendCommand/","title":"SendCommand","lastUpdatedAt":"2024-01-14T16:00:00.000Z","lastUpdated":"1/14/2024"},"frontmatter":{"draft":false,"tags":[]}},{"fields":{"slug":"/","title":"Obsibian Template for Gatsby Theme Primer Wiki","lastUpdatedAt":"2021-10-13T06:21:51.000Z","lastUpdated":"10/13/2021"},"frontmatter":{"draft":false,"tags":[]}}]}},
    "staticQueryHashes": ["2230547434","2320115945","3495835395","451533639"]}